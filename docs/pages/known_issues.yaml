# ==============================================================================
# Epika - 既知の問題リスト
# ==============================================================================
# このファイルを編集後、publish_known_issues.command をダブルクリックで
# HTMLを生成してGitHubにプッシュできます。
#
# 【IDの採番規則】
#   FBXXXX (Known Issue) 形式で連番
#
# 【ステータス】
#   investigating - 調査中
#   confirmed     - 確認済み（修正予定あり）
#   fixing        - 修正作業中
#   wontfix       - 仕様として対応しない
#
# 【解決済みにする場合】
#   issues から resolved にエントリを移動し、resolved_date を追加
# ==============================================================================

# 最終更新日（HTML生成時に自動更新されます）
last_updated: "2025-12-23"

# ==============================================================================
# 既知の問題（Open）
# ==============================================================================
issues:
  - id: "FB0001"
    title: "掘り出し物画面を開くとパンドラボックスの画面になる"
    category: "商店"
    status: "investigating"
    reported_date: "2025-12-19"
    description: |
      商店の「掘り出し物」メニューを選択すると、パンドラボックスの画面が表示されてしまう問題。
    details: |
      【再現手順】
      1. 商店画面を開く
      2. 「掘り出し物」を選択

      【期待動作】
      掘り出し物の画面が表示される

      【実際の動作】
      パンドラボックスの画面が表示される
    workaround: ""
    fix_plan: |
      掘り出し物機能の完成時に修正予定。商店は0.8.0にて基本機能を完成させる予定です。

  - id: "FB0014"
    title: "獲得系アイテムが全て経験値に関するスキルしか持っていない"
    category: "マスターデータ"
    status: "confirmed"
    reported_date: "2025-12-23"
    description: |
      獲得系アイテムに付与されているスキルが、全て経験値に関するものになっている。
    details: |
      スキルを正しく割り当てていないため。
    workaround: ""
    fix_plan: |
      0.9.xの間に正しいスキルを割り当て予定。

  - id: "FB0019"
    title: "複数パーティで探索を行うと端末が異常に熱くなる場合がある"
    category: "パフォーマンス"
    status: "confirmed"
    reported_date: "2025-12-23"
    description: |
      複数のパーティで同時に探索を行うと、端末が異常に熱くなる場合がある。
    details: |
      複数パーティの並列探索処理による高負荷が原因の可能性がある。
    workaround: ""
    fix_plan: |
      0.7.82（3）で基本的に修正済み。追加の改善がないか調査中。

# ==============================================================================
# 解決済みの問題（Closed）
# ==============================================================================
resolved:
  - id: "FB0002"
    title: "デバッグメニューのデータ消去でアラートが表示されない"
    category: "デバッグ"
    status: "fixed"
    reported_date: "2025-12-20"
    resolved_date: "2025-12-21"
    resolved_version: "0.7.70"
    description: |
      デバッグメニューからデータ消去を実行しても確認アラートが表示されない。
    resolution: |
      0.7.70にて修正済み。アラート表示処理の修正により解決。

  - id: "FB0003"
    title: "iOS 17で冒険タブのパーティをタップするとアプリがクラッシュする"
    category: "冒険タブ"
    status: "fixed"
    reported_date: "2025-12-20"
    resolved_date: "2025-12-21"
    resolved_version: "0.7.70"
    description: |
      冒険タブでパーティをタップするとアプリがクラッシュする。
    details: |
      iOS 17のAttributeGraphのバグにより、Swift 6.2のApproachable Concurrency設定との組み合わせでクラッシュが発生。
    resolution: |
      0.7.70にて修正済み。Swift Concurrency設定を調整し、NavigationStackの二重ネスト問題を修正。サポート対象をiOS 17.1以降に維持。

  - id: "FB0004"
    title: "アイテムを複数装備した状態で転職するとキャラクターのデッドロックが発生する"
    category: "装備"
    status: "fixed"
    reported_date: "2025-12-20"
    resolved_date: "2025-12-21"
    resolved_version: "0.7.70"
    description: |
      転職時の装備可能数の変動により、キャラクターが所持できるアイテム数を超え、チェックによりエラーが発生。
    resolution: |
      0.7.70にて修正済み。転職時に装備を全てインベントリに戻す処理を追加。デバッグメニューに復旧用の全装備解除機能も追加。

  - id: "FB0005"
    title: "装備によって攻撃回数が増えない"
    category: "戦闘"
    status: "fixed"
    reported_date: "2025-12-21"
    resolved_date: "2025-12-21"
    resolved_version: "0.7.70 (0772)"
    description: |
      攻撃回数が増加する装備を装着しても、戦闘時の攻撃回数が増えない。
    resolution: |
      0.7.70にて修正済み。

  - id: "FB0006"
    title: "ボスが道中で出現する場合がある"
    category: "ダンジョン"
    status: "fixed"
    reported_date: "2025-12-21"
    resolved_date: "2025-12-21"
    resolved_version: "0.7.70 (0772)"
    description: |
      ダンジョン最深部で出現するはずのボスが、道中のフロアで出現してしまうことがある。
    resolution: |
      0.7.70にて修正済み（審査中）。ボスエンカウントはボスフロア（最終フロア）でのみ出現するよう修正。

  - id: "FB0007"
    title: "迷宮の称号を変えても敵が強くならない"
    category: "ダンジョン"
    status: "fixed"
    reported_date: "2025-12-21"
    resolved_date: "2025-12-21"
    resolved_version: "0.7.70 (0772)"
    description: |
      迷宮の称号を変更しても、敵の強さが変化しない。
    resolution: |
      0.7.70にて修正済み（審査中）。難易度の称号statMultiplierを敵レベルに乗算するよう修正。

  - id: "FB0008"
    title: "魔法使い魔法・僧侶魔法が発動しない"
    category: "戦闘"
    status: "fixed"
    reported_date: "2025-12-21"
    resolved_date: "2025-12-21"
    resolved_version: "0.7.80"
    description: |
      魔法使い魔法や僧侶魔法を習得していても、戦闘中に発動しない。
    resolution: |
      行動選択ロジックが重み付きランダムになっており、100%設定でも確実に発動しなかった。
      また、spellSchoolのマッピングが逆になっていた問題も修正。

  - id: "FB0009"
    title: "ブレスを習得していないキャラがブレスを発動する"
    category: "戦闘"
    status: "fixed"
    reported_date: "2025-12-21"
    resolved_date: "2025-12-22"
    resolved_version: "0.7.80 (0780)"
    description: |
      ブレススキルを習得していないキャラクターがブレス攻撃を発動してしまう。
    resolution: |
      BattleActionResource.makeDefaultでbreathDamage > 0の場合に自動でブレスチャージを付与していたのを削除。
      breathVariantスキルを習得したキャラのみがブレスを使用できるよう修正。

  - id: "FB0010"
    title: "探索ログが表示されなくなる"
    category: "探索"
    status: "fixed"
    reported_date: "2025-12-22"
    resolved_date: "2025-12-22"
    resolved_version: "0.7.81"
    description: |
      探索ログが表示されなくなる問題。
    resolution: |
      0.7.81にて修正済み。探索データの正規化処理と、ベータテスト用機能に探索ログ削除機能を追加。

  - id: "FB0011"
    title: "iOS 18でドロップ通知の背景が暗く読みにくい"
    category: "UI"
    status: "fixed"
    reported_date: "2025-12-22"
    resolved_date: "2025-12-22"
    description: |
      iOS 18でアイテムのドロップ通知の背景が暗くなり、ドロップ内容が極端に読みにくい。
    resolution: |
      修正済み。12/23までに修正を公開予定。背景にシステムカラーとブラー効果を適用し視認性を改善。

  - id: "FB0012"
    title: "パーティのレア倍率にスキル効果が反映されていない"
    category: "UI"
    status: "fixed"
    reported_date: "2025-12-23"
    resolved_date: "2025-12-23"
    description: |
      パーティのレア倍率表示にパーティメンバーのスキル効果が反映されていない。
    resolution: |
      UI表示のみの問題。実際のドロップ計算には反映されていた。

  - id: "FB0013"
    title: "敵キャラが複数回攻撃をすることがある"
    category: "戦闘"
    status: "fixed"
    reported_date: "2025-12-23"
    resolved_date: "2025-12-23"
    resolved_version: "0.7.82 (2)"
    description: |
      敵キャラクターが1ターンに複数回攻撃を行うことがある。
    details: |
      physicalEvadeアクションのactor/targetが逆に記録されていた。
      味方が敵を攻撃して敵が回避した場合に「敵の攻撃！味方は攻撃をかわした！」と表示され、
      敵が何度も攻撃しているように見えていた。
    resolution: |
      physicalEvadeのactor/targetをphysicalDamageと同様にactor=攻撃側、target=防御側に統一。

  - id: "FB0015"
    title: "ギルドを最大まで拡張するとギルド情報の取得に失敗する"
    category: "ギルド"
    status: "fixed"
    reported_date: "2025-12-23"
    resolved_date: "2025-12-23"
    resolved_version: "0.7.82 (2)"
    description: |
      ギルドを最大まで拡張すると、ギルドタブで「ギルド情報の取得に失敗しました」エラーが表示される。
    details: |
      戦士スキル（Skill 65014）のprocRate stackingデータが不正なため、ギルド情報の読み込みに失敗していた。
    resolution: |
      マスターデータとコードの不一致の修正により改善。

  - id: "FB0016"
    title: "探索中に問題がないのに帰還してしまう"
    category: "探索"
    status: "fixed"
    reported_date: "2025-12-23"
    resolved_date: "2025-12-23"
    resolved_version: "0.7.82 (2)"
    description: |
      パーティに問題がない状態（HP満タン、戦闘可能）なのに、探索中に帰還してしまう。
    details: |
      FB0015と同じ原因（戦士スキルのデータ不整合）により、データ読み込み時にエラーが発生し帰還処理が実行されていた。
    resolution: |
      マスターデータとコードの不一致の修正により改善。

  - id: "FB0018"
    title: "バックグラウンドから復帰後に探索が進まない場合がある"
    category: "探索"
    status: "fixed"
    reported_date: "2025-12-23"
    resolved_date: "2025-12-25"
    resolved_version: "0.7.83(1)"
    description: |
      アプリをバックグラウンドから復帰した後、探索が進行しなくなる場合がある。
    details: |
      探索再開時のタイマー計算で、元の開始時刻ではなく復帰時刻を基準にしていたため、待機時間がずれていた。
    resolution: |
      探索再開時に元の開始時刻と既存イベント数を正しく使用するよう修正。

  - id: "FB0020"
    title: "自動売却が機能せず、入手したアイテムが売られない場合がある"
    category: "アイテム"
    status: "fixed"
    reported_date: "2025-12-24"
    resolved_date: "2025-12-25"
    resolved_version: "0.7.83(1)"
    description: |
      自動売却を設定していても、入手したアイテムが売却されない場合がある。
    details: |
      登録時は6要素キー、判定時は3要素キーで比較していたため一致しなかった。
    resolution: |
      ドロップ時・インベントリ売却時も6要素キーで照合するよう修正。

  - id: "FB0021"
    title: "在庫整理でノーマルアイテムもキャット・チケットを入手できる"
    category: "アイテム"
    status: "fixed"
    reported_date: "2025-12-24"
    resolved_date: "2025-12-25"
    resolved_version: "0.7.82(4)"
    description: |
      在庫整理機能でノーマルアイテムを整理した際にも、キャット・チケットを入手できてしまう。
    details: |
      ノーマルアイテムに対するレアリティチェックが不足していた。
    resolution: |
      cleanupStock でノーマルアイテムを除外するガードを追加。

  - id: "FB0022"
    title: "僧侶魔法、特にバリア系統が発動しない場合がある"
    category: "戦闘"
    status: "fixed"
    reported_date: "2025-12-24"
    resolved_date: "2025-12-25"
    resolved_version: "0.7.83(1)"
    description: |
      僧侶魔法、特にバリア系統の魔法が発動しない場合がある。
    details: |
      buff/cleanse系の呪文カテゴリが未実装だった。
    resolution: |
      buff/cleanse呪文カテゴリを実装し、バリア系統の魔法が正しく発動するよう修正。

  - id: "FB0023"
    title: "探索中にパーティメンバーを変更できてしまう"
    category: "探索"
    status: "fixed"
    reported_date: "2025-12-24"
    resolved_date: "2025-12-25"
    resolved_version: "0.7.83(1)"
    description: |
      探索中のパーティのメンバーを変更できてしまう問題。
    details: |
      パーティ詳細画面の「メンバーを変更する」リンクに探索中チェックがなかった。
    resolution: |
      探索中のパーティではメンバー変更リンクを無効化するよう修正。

  - id: "FB0024"
    title: "パーティ詳細画面から装備更新してもステータス変更通知が表示されない"
    category: "UI"
    status: "fixed"
    reported_date: "2025-12-25"
    resolved_date: "2025-12-25"
    resolved_version: "0.7.83(1)"
    description: |
      パーティ詳細画面から装備の更新を行っても、ステータスの変更通知が表示されない。
    details: |
      装備変更後のステータス差分表示が動作していなかった。
    resolution: |
      パーティ詳細画面でステータス変動通知を表示するよう修正。

  - id: "FB0025"
    title: "最新の迷宮をクリアしてもストーリーが解放されない"
    category: "ストーリー"
    status: "fixed"
    reported_date: "2025-12-25"
    resolved_date: "2025-12-25"
    resolved_version: "0.7.83(1)"
    description: |
      解放されている一番新しい迷宮をクリアしても、次のストーリーが解放されない。
    details: |
      迷宮クリア時のストーリー解放判定に問題があった。
    resolution: |
      ダンジョンクリア時のストーリー解放処理を修正。
